# Code generated by kickr; DO NOT EDIT.

---
include:

  # pre-commit template
  # https://gitlab.com/to-be-continuous/pre-commit
  - project: to-be-continuous/pre-commit
    ref: 781cb6e8a6a4009a4ca29357fd6aa1a81f9867cd # 1.4.2
    file: templates/gitlab-ci-pre-commit.yml

variables:
  BUILD_DIR: dist
  PRE_COMMIT_FILE: .pre-commit-config.yaml

hugo-build:
  image: docker.io/library/debian:trixie-slim
  stage: build
  needs:
    - semantic-release-info
  variables:
    # renovate: datasource=github-tags packageName=jdx/mise depName=mise
    MISE_VERSION: v2026.1.6
  rules:
    - !reference [.test-policy, rules]
  before_script:
    - export PATH="$HOME/.local/share/mise/shims:$PATH"
    - apt-get update -yq && apt-get install -yq curl git
    - curl https://mise.run | MISE_INSTALL_PATH=/usr/local/bin/mise MISE_VERSION=$MISE_VERSION sh
    # renovate: datasource=golang-version packageName=golang/go depName=golang
    - mise use -g golang@1.25.5
    # renovate: datasource=github-tags packageName=gohugoio/hugo depName=hugo
    - mise use -g hugo-extended@0.153.2
    # renovate: datasource=github-tags packageName=sass/dart-sass depName=dart-sass
    - mise use -g github:sass/dart-sass@1.97.2
  script:
    - >
      [ -z "$HUGO_PROJECT_DIR" ] || cd "$HUGO_PROJECT_DIR"
    - hugo --gc --minify --destination "$CI_PROJECT_DIR/$BUILD_DIR" --logLevel "${LOG_LEVEL:-info}"
  artifacts:
    name: "$CI_JOB_NAME artifacts from $CI_PROJECT_NAME on $CI_COMMIT_REF_SLUG"
    paths:
      - $BUILD_DIR
    expire_in: 1 day
